<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NASA Mission Control: Switch 2 Acquisition</title>
    <meta name="description" content="GARDEN-Enhanced Nintendo Switch 2 Acquisition Mission Control Center">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Roboto+Mono:wght@300;400;500&display=swap" rel="stylesheet">
    <style>
        :root {
            --nasa-blue: #0B3D91;
            --nasa-red: #FC3D21;
            --nasa-white: #FFFFFF;
            --mission-green: #00FF41;
            --warning-amber: #FFA500;
            --critical-red: #FF4444;
            --space-black: #000000;
            --console-gray: #1a1a1a;
            --panel-dark: #0d1117;
            --border-light: #30363d;
            --timeline-past: rgba(255, 255, 255, 0.3);
            --timeline-future: #00FF41;
            --timeline-active: #FFA500;
        }

        * { 
            margin: 0; 
            padding: 0; 
            box-sizing: border-box; 
        }
        
        body {
            font-family: 'Roboto Mono', monospace;
            background: linear-gradient(135deg, var(--space-black) 0%, var(--nasa-blue) 50%, var(--space-black) 100%);
            color: var(--nasa-white);
            min-height: 100vh;
            overflow-x: auto;
            background-attachment: fixed;
        }

        /* NASA Header */
        .nasa-header {
            background: linear-gradient(90deg, var(--nasa-blue) 0%, var(--panel-dark) 100%);
            padding: 20px;
            border-bottom: 3px solid var(--nasa-red);
            margin-bottom: 20px;
            text-align: center;
            box-shadow: 0 4px 20px rgba(252, 61, 33, 0.3);
            position: relative;
            overflow: hidden;
        }

        .nasa-header::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            animation: sweep 3s infinite;
        }

        @keyframes sweep {
            0% { left: -100%; }
            100% { left: 100%; }
        }

        .nasa-logo {
            font-family: 'Orbitron', monospace;
            font-size: 2.5em;
            font-weight: 900;
            color: var(--nasa-white);
            text-shadow: 0 0 20px var(--nasa-red);
            margin-bottom: 10px;
        }

        .mission-title {
            font-family: 'Orbitron', monospace;
            font-size: 1.2em;
            color: var(--nasa-red);
            font-weight: 700;
            letter-spacing: 2px;
        }

        .mission-subtitle {
            font-size: 0.9em;
            color: var(--warning-amber);
            margin-top: 5px;
            letter-spacing: 1px;
            margin-bottom: 15px;
        }

        /* Master Controls */
        .master-controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 15px;
        }

        .master-btn {
            background: linear-gradient(145deg, var(--panel-dark), var(--console-gray));
            border: 1px solid var(--nasa-red);
            color: var(--nasa-white);
            padding: 8px 16px;
            border-radius: 6px;
            font-family: 'Orbitron', monospace;
            font-weight: bold;
            font-size: 0.8rem;
            cursor: pointer;
            transition: all 0.3s ease;
            letter-spacing: 1px;
            text-transform: uppercase;
        }

        .master-btn:hover {
            background: linear-gradient(145deg, var(--nasa-red), var(--nasa-blue));
            box-shadow: 0 0 15px rgba(252, 61, 33, 0.5);
            transform: translateY(-2px);
        }

        /* Mission Control Grid */
        .mission-control {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 20px;
            padding: 20px;
            max-width: 1600px;
            margin: 0 auto;
        }

        /* NASA Control Panels */
        .control-panel {
            background: linear-gradient(145deg, var(--panel-dark) 0%, var(--console-gray) 100%);
            border: 2px solid var(--border-light);
            border-radius: 8px;
            padding: 20px;
            box-shadow: 
                0 4px 15px rgba(0, 0, 0, 0.5),
                inset 0 1px 0 rgba(255, 255, 255, 0.1);
            position: relative;
            overflow: hidden;
            transition: all 0.3s ease;
        }

        .control-panel:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(252, 61, 33, 0.2);
            border-color: rgba(252, 61, 33, 0.4);
        }

        .control-panel::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, var(--nasa-red), var(--warning-amber), var(--mission-green));
        }

        .panel-header {
            font-family: 'Orbitron', monospace;
            font-size: 1.1em;
            font-weight: 700;
            color: var(--nasa-white);
            margin-bottom: 15px;
            text-align: center;
            border-bottom: 1px solid var(--border-light);
            padding-bottom: 10px;
            text-transform: uppercase;
            letter-spacing: 1px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .panel-header:hover {
            background: rgba(252, 61, 33, 0.1);
            border-radius: 5px;
            padding: 5px 10px;
            margin: -5px -10px 10px -10px;
        }

        /* NASA Badge */
        .nasa-badge {
            position: absolute;
            top: 10px;
            right: 15px;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--nasa-red);
            display: flex;
            align-items: center;
            justify-content: center;
            font-family: 'Orbitron', monospace;
            font-weight: 900;
            font-size: 0.8em;
            color: var(--nasa-white);
            box-shadow: 0 0 10px rgba(252, 61, 33, 0.5);
        }

        /* Collapsible Panel Content */
        .panel-content {
            transition: all 0.4s ease;
            overflow: hidden;
        }

        .panel-content.collapsed {
            max-height: 0;
            opacity: 0;
            margin-top: -15px;
        }

        .panel-content.expanded {
            max-height: 2000px;
            opacity: 1;
        }

        .collapse-indicator {
            font-family: 'Orbitron', monospace;
            font-size: 1.2rem;
            font-weight: bold;
            color: var(--mission-green);
            transition: transform 0.3s ease;
            user-select: none;
        }

        .collapse-indicator.collapsed {
            transform: rotate(-90deg);
        }

        /* TACTICAL TIMELINE - Exact match to screenshot */
        .timeline-container {
            background: rgba(0, 0, 0, 0.4);
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
            max-height: 400px;
            overflow-y: auto;
            border: 1px solid var(--border-light);
        }

        .timeline-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid var(--border-light);
        }

        .current-time {
            font-family: 'Orbitron', monospace;
            font-size: 1.2em;
            font-weight: bold;
            color: var(--nasa-red);
            text-shadow: 0 0 10px var(--nasa-red);
        }

        .timeline-controls {
            display: flex;
            gap: 10px;
        }

        .timeline-btn {
            background: rgba(11, 61, 145, 0.3);
            border: 1px solid var(--nasa-blue);
            color: var(--nasa-white);
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.7em;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .timeline-btn:hover {
            background: rgba(252, 61, 33, 0.3);
            border-color: var(--nasa-red);
        }

        .timeline-event {
            display: flex;
            align-items: center;
            margin: 12px 0;
            position: relative;
            padding: 8px 0;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .timeline-event:hover {
            background: rgba(252, 61, 33, 0.1);
            border-radius: 5px;
            padding: 8px 10px;
            margin: 12px -10px;
        }

        .timeline-time {
            font-family: 'Orbitron', monospace;
            font-size: 0.85em;
            font-weight: bold;
            width: 60px;
            text-align: right;
            margin-right: 15px;
        }

        .timeline-connector {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-right: 15px;
        }

        .timeline-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            border: 2px solid;
            transition: all 0.3s ease;
            position: relative;
        }

        .timeline-line {
            width: 2px;
            height: 40px;
            margin: 2px 0;
        }

        /* Timeline Event States */
        .timeline-event.past .timeline-time {
            color: var(--timeline-past);
        }

        .timeline-event.past .timeline-dot {
            border-color: var(--timeline-past);
            background: transparent;
        }

        .timeline-event.past .timeline-line {
            background: var(--timeline-past);
        }

        .timeline-event.future .timeline-time {
            color: var(--timeline-future);
        }

        .timeline-event.future .timeline-dot {
            border-color: var(--timeline-future);
            background: var(--timeline-future);
            box-shadow: 0 0 10px rgba(0, 255, 65, 0.3);
        }

        .timeline-event.future .timeline-line {
            background: var(--timeline-future);
        }

        .timeline-event.active .timeline-time {
            color: var(--timeline-active);
            animation: pulse 1s infinite;
        }

        .timeline-event.active .timeline-dot {
            border-color: var(--timeline-active);
            background: var(--timeline-active);
            animation: flashDot 1s infinite;
            box-shadow: 0 0 15px rgba(255, 165, 0, 0.5);
        }

        .timeline-event.active .timeline-line {
            background: var(--timeline-active);
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }

        @keyframes flashDot {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.2); }
        }

        .timeline-info {
            flex: 1;
        }

        .timeline-store {
            font-weight: bold;
            font-size: 0.9em;
            margin-bottom: 3px;
            color: var(--nasa-white);
        }

        .timeline-phase {
            font-size: 0.75em;
            opacity: 0.8;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .timeline-status {
            font-size: 0.7em;
            margin-top: 2px;
            font-family: 'Orbitron', monospace;
            font-weight: bold;
        }

        /* Store-specific colors */
        .store-bestbuy { color: #FFD700; }
        .store-gamestop { color: #FF6B35; }
        .store-target { color: #CC0000; }
        .store-walmart { color: #004C91; }

        /* Phase-specific styling */
        .phase-departure .timeline-phase { color: #87CEEB; }
        .phase-lineup .timeline-phase { color: var(--warning-amber); }
        .phase-launch .timeline-phase { color: var(--nasa-red); }

        /* Mission Timer */
        .mission-timer {
            text-align: center;
            font-family: 'Orbitron', monospace;
            font-size: 2.2em;
            font-weight: 900;
            color: var(--nasa-red);
            margin: 20px 0;
            text-shadow: 0 0 15px var(--nasa-red);
            padding: 15px;
            background: rgba(252, 61, 33, 0.1);
            border-radius: 8px;
            border: 1px solid var(--nasa-red);
        }

        .probability-display {
            font-family: 'Orbitron', monospace;
            font-size: 1.3em;
            text-align: center;
            color: var(--mission-green);
            margin: 15px 0;
            text-shadow: 0 0 10px var(--mission-green);
            font-weight: 700;
        }

        /* Navigation Panel Integration */
        .navigation-panel {
            position: relative;
        }

        .map-container {
            width: 100%;
            height: 400px;
            border-radius: 8px;
            overflow: hidden;
            border: 2px solid var(--border-light);
            background: var(--panel-dark);
            position: relative;
        }

        #map {
            width: 100%;
            height: 100%;
        }

        .map-controls {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 1rem;
            flex-wrap: wrap;
        }

        .map-btn {
            background: linear-gradient(145deg, var(--nasa-blue), var(--panel-dark));
            border: 1px solid var(--nasa-blue);
            color: var(--nasa-white);
            padding: 0.5rem 1rem;
            border-radius: 4px;
            font-family: 'Orbitron', monospace;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.8rem;
        }

        .map-btn:hover {
            background: linear-gradient(145deg, var(--nasa-red), var(--nasa-blue));
            transform: translateY(-2px);
        }

        .coordinates-display {
            background: rgba(11, 61, 145, 0.2);
            padding: 0.5rem;
            border-radius: 4px;
            font-size: 0.8rem;
            margin-bottom: 1rem;
            border: 1px solid var(--nasa-blue);
        }

        /* Data rows and mission buttons */
        .data-row {
            display: flex;
            justify-content: space-between;
            padding: 6px 0;
            border-bottom: 1px solid var(--border-light);
            font-size: 0.85em;
        }

        .data-label {
            opacity: 0.8;
            color: #ccc;
        }

        .data-value {
            font-weight: bold;
            color: var(--mission-green);
        }

        .mission-button {
            background: linear-gradient(145deg, var(--nasa-blue), var(--panel-dark));
            border: 2px solid var(--nasa-blue);
            color: var(--nasa-white);
            padding: 12px 18px;
            border-radius: 6px;
            cursor: pointer;
            margin: 8px 0;
            font-family: 'Orbitron', monospace;
            font-weight: 500;
            font-size: 0.85em;
            width: 100%;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .mission-button:hover {
            background: linear-gradient(145deg, var(--nasa-red), var(--nasa-blue));
            box-shadow: 0 0 15px rgba(252, 61, 33, 0.5);
            transform: translateY(-2px);
        }

        @media (max-width: 768px) {
            .mission-control {
                grid-template-columns: 1fr;
                padding: 10px;
            }
            .nasa-logo {
                font-size: 1.8em;
            }
            .mission-timer {
                font-size: 1.6em;
            }
        }
    </style>
</head>
<body>
    <!-- NASA Header -->
    <div class="nasa-header">
        <div class="nasa-logo">🚀 SWITCH 2 MISSION CONTROL</div>
        <div class="mission-title">OPERATION: NINTENDO ACQUISITION</div>
        <div class="mission-subtitle">GARDEN-Enhanced Strategic Mission // Enhanced Command Center</div>
        <div class="master-controls">
            <button class="master-btn" onclick="expandAll()">📊 EXPAND ALL</button>
            <button class="master-btn" onclick="collapseAll()">📋 COLLAPSE ALL</button>
            <button class="master-btn" onclick="focusMode()">🎯 FOCUS MODE</button>
        </div>
    </div>

    <div class="mission-control">
        <!-- POSITION 1: TACTICAL TIMELINE - FIRST POSITION -->
        <div class="control-panel">
            <div class="nasa-badge">⏰</div>
            <div class="panel-header" onclick="togglePanel('timeline-content', 'timeline-indicator')">
                ⏰ TACTICAL TIMELINE
                <div class="collapse-indicator" id="timeline-indicator">▼</div>
            </div>
            <div class="panel-content expanded" id="timeline-content">
                <div class="timeline-header">
                    <div class="current-time" id="current-time">16:42:15</div>
                    <div class="timeline-controls">
                        <button class="timeline-btn" onclick="scrollToNext()">NEXT ▼</button>
                        <button class="timeline-btn" onclick="resetTimeline()">RESET</button>
                    </div>
                </div>
                
                <div class="timeline-container" id="timeline-container">
                    <!-- Timeline events will be populated by JavaScript -->
                </div>
                
                <div class="data-row">
                    <span class="data-label">Next Event:</span>
                    <span class="data-value" id="next-event">Mission Complete</span>
                </div>
                <div class="data-row">
                    <span class="data-label">Time to Next:</span>
                    <span class="data-value" id="time-to-next">T+00:00:00</span>
                </div>
            </div>
        </div>

        <!-- POSITION 2: TACTICAL NAVIGATION -->
        <div class="control-panel navigation-panel">
            <div class="nasa-badge">📍</div>
            <div class="panel-header" onclick="togglePanel('navigation-content', 'navigation-indicator')">
                📍 TACTICAL NAVIGATION
                <div class="collapse-indicator" id="navigation-indicator">▼</div>
            </div>
            <div class="panel-content expanded" id="navigation-content">
                <div class="coordinates-display" id="coordinates">
                    📍 Coordinates: Acquiring GPS lock...
                </div>
                
                <div class="map-controls">
                    <button class="map-btn" onclick="centerMap()">CENTER</button>
                    <button class="map-btn" onclick="enableRouting()">ROUTE</button>
                    <button class="map-btn" onclick="toggleTraffic()">TRAFFIC</button>
                    <button class="map-btn" onclick="toggleTracking()">TRACK</button>
                    <button class="map-btn" onclick="showLegend()">LEGEND</button>
                </div>
                
                <div class="map-container">
                    <div id="map"></div>
                </div>
            </div>
        </div>

        <!-- POSITION 3: MISSION COUNTDOWN -->
        <div class="control-panel">
            <div class="nasa-badge">🎯</div>
            <div class="panel-header" onclick="togglePanel('timer-content', 'timer-indicator')">
                🎯 MISSION COUNTDOWN
                <div class="collapse-indicator" id="timer-indicator">▼</div>
            </div>
            <div class="panel-content expanded" id="timer-content">
                <div class="mission-timer" id="countdown">00:00:00</div>
                <div class="probability-display">MISSION SUCCESS: 97.5%</div>
                
                <div class="mission-button" onclick="initiateCountdown()">START COUNTDOWN</div>
                <div class="mission-button" onclick="pauseCountdown()">HOLD</div>
                <div class="mission-button" onclick="resetCountdown()">RESET</div>
            </div>
        </div>
    </div>

    <script>
        // Timeline data with the exact events from screenshot
        const timelineEvents = [
            { time: '12:45', store: 'Target', phase: 'lineup', type: 'PREPARE FOR LAUNCH', status: 'QUEUE', url: 'https://www.google.com/maps/dir/Annapolis,+MD/Target,+1 Market St,+Annapolis,+MD+21401' },
            { time: '14:00', store: 'Target', phase: 'launch', type: 'LAUNCH', status: 'GO', url: 'https://www.google.com/maps/dir/Annapolis,+MD/Target,+1 Market St,+Annapolis,+MD+21401' },
            { time: '15:00', store: 'Walmart', phase: 'departure', type: 'DEPARTURE', status: 'FINAL', url: 'https://www.google.com/maps/dir/Annapolis,+MD/Walmart,+160 Jennifer Rd,+Annapolis,+MD+21401' },
            { time: '15:15', store: 'Walmart', phase: 'lineup', type: 'PREPARE FOR LAUNCH', status: 'QUEUE', url: 'https://www.google.com/maps/dir/Annapolis,+MD/Walmart,+160 Jennifer Rd,+Annapolis,+MD+21401' },
            { time: '16:00', store: 'Walmart', phase: 'launch', type: 'LAUNCH', status: 'GO', url: 'https://www.google.com/maps/dir/Annapolis,+MD/Walmart,+160 Jennifer Rd,+Annapolis,+MD+21401' }
        ];

        let map, userLocation;
        let nextEventIndex = 0;

        // Timeline functions
        function updateCurrentTime() {
            const now = new Date();
            const timeString = now.toLocaleTimeString('en-US', { 
                hour12: false, 
                hour: '2-digit', 
                minute: '2-digit', 
                second: '2-digit' 
            });
            document.getElementById('current-time').textContent = timeString;
        }

        function getCurrentTimeMinutes() {
            const now = new Date();
            return now.getHours() * 60 + now.getMinutes();
        }

        function timeToMinutes(timeString) {
            const [hours, minutes] = timeString.split(':').map(Number);
            return hours * 60 + minutes;
        }

        function getEventState(eventTime) {
            const currentMinutes = getCurrentTimeMinutes();
            const eventMinutes = timeToMinutes(eventTime);
            
            if (eventMinutes < currentMinutes) return 'past';
            if (eventMinutes === currentMinutes || 
                (eventMinutes > currentMinutes && eventMinutes <= currentMinutes + 5)) return 'active';
            return 'future';
        }

        function updateTimeline() {
            const container = document.getElementById('timeline-container');
            const currentMinutes = getCurrentTimeMinutes();
            
            container.innerHTML = '';
            nextEventIndex = -1;
            
            timelineEvents.forEach((event, index) => {
                const eventMinutes = timeToMinutes(event.time);
                const state = getEventState(event.time);
                
                // Find next event
                if (nextEventIndex === -1 && eventMinutes >= currentMinutes) {
                    nextEventIndex = index;
                }
                
                const eventDiv = document.createElement('div');
                eventDiv.className = `timeline-event ${state}`;
                eventDiv.onclick = () => window.open(event.url, '_blank');
                
                eventDiv.innerHTML = `
                    <div class="timeline-time">${event.time}</div>
                    <div class="timeline-connector">
                        <div class="timeline-dot"></div>
                        ${index < timelineEvents.length - 1 ? '<div class="timeline-line"></div>' : ''}
                    </div>
                    <div class="timeline-info">
                        <div class="timeline-store store-${event.store.toLowerCase().replace(' ', '')}">${event.store}</div>
                        <div class="timeline-phase phase-${event.phase}">${event.type}</div>
                        <div class="timeline-status">${event.status}</div>
                    </div>
                `;
                
                container.appendChild(eventDiv);
            });
            
            updateNextEventInfo();
        }

        function updateNextEventInfo() {
            const nextEventElement = document.getElementById('next-event');
            const timeToNextElement = document.getElementById('time-to-next');
            
            if (nextEventIndex >= 0 && nextEventIndex < timelineEvents.length) {
                const nextEvent = timelineEvents[nextEventIndex];
                nextEventElement.textContent = `${nextEvent.store} ${nextEvent.type}`;
                
                const currentMinutes = getCurrentTimeMinutes();
                const eventMinutes = timeToMinutes(nextEvent.time);
                const diffMinutes = eventMinutes - currentMinutes;
                
                if (diffMinutes > 0) {
                    const hours = Math.floor(diffMinutes / 60);
                    const minutes = diffMinutes % 60;
                    timeToNextElement.textContent = `T-${hours}:${minutes.toString().padStart(2, '0')}:00`;
                } else {
                    timeToNextElement.textContent = 'NOW';
                }
            } else {
                nextEventElement.textContent = 'Mission Complete';
                timeToNextElement.textContent = 'T+00:00:00';
            }
        }

        // Google Maps Integration
        function initMap() {
            map = new google.maps.Map(document.getElementById('map'), {
                zoom: 12,
                center: { lat: 38.9784, lng: -76.5951 },
                styles: [
                    { elementType: "geometry", stylers: [{ color: "#242f3e" }] },
                    { elementType: "labels.text.stroke", stylers: [{ color: "#242f3e" }] },
                    { elementType: "labels.text.fill", stylers: [{ color: "#746855" }] },
                    {
                        featureType: "road",
                        elementType: "geometry",
                        stylers: [{ color: "#38414e" }]
                    },
                    {
                        featureType: "road.highway",
                        elementType: "geometry",
                        stylers: [{ color: "#FF8C00" }]
                    },
                    {
                        featureType: "road.arterial",
                        elementType: "geometry",
                        stylers: [{ color: "#FC3D21" }]
                    }
                ],
                mapTypeId: 'hybrid'
            });

            // Add location markers
            const locations = [
                { lat: 38.9784, lng: -76.5951, name: "Best Buy Annapolis", color: "#00FF41" },
                { lat: 38.9856, lng: -76.5749, name: "Target Annapolis", color: "#FFD700" },
                { lat: 38.9698, lng: -76.5985, name: "Walmart Annapolis", color: "#FC3D21" },
                { lat: 38.9889, lng: -76.5542, name: "GameStop Annapolis", color: "#00FFFF" }
            ];

            locations.forEach(location => {
                new google.maps.Marker({
                    position: { lat: location.lat, lng: location.lng },
                    map: map,
                    title: location.name,
                    icon: {
                        path: google.maps.SymbolPath.CIRCLE,
                        scale: 8,
                        fillColor: location.color,
                        fillOpacity: 1,
                        strokeWeight: 2,
                        strokeColor: '#FFFFFF'
                    }
                });
            });

            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(position => {
                    userLocation = {
                        lat: position.coords.latitude,
                        lng: position.coords.longitude
                    };
                    
                    document.getElementById('coordinates').innerHTML = 
                        `📍 Coordinates: ${userLocation.lat.toFixed(6)}, ${userLocation.lng.toFixed(6)}`;
                    
                    new google.maps.Marker({
                        position: userLocation,
                        map: map,
                        title: "Your Location",
                        icon: {
                            path: google.maps.SymbolPath.CIRCLE,
                            scale: 6,
                            fillColor: '#00FF41',
                            fillOpacity: 1,
                            strokeWeight: 2,
                            strokeColor: '#FFFFFF'
                        }
                    });
                });
            }
        }

        // Panel functionality
        function togglePanel(contentId, indicatorId) {
            const content = document.getElementById(contentId);
            const indicator = document.getElementById(indicatorId);
            
            if (content.classList.contains('expanded')) {
                content.classList.remove('expanded');
                content.classList.add('collapsed');
                indicator.classList.add('collapsed');
            } else {
                content.classList.remove('collapsed');
                content.classList.add('expanded');
                indicator.classList.remove('collapsed');
            }
        }

        function collapseAll() {
            const panels = ['timeline-content', 'navigation-content', 'timer-content'];
            panels.forEach(panelId => {
                const content = document.getElementById(panelId);
                const indicatorId = panelId.replace('-content', '-indicator');
                const indicator = document.getElementById(indicatorId);
                
                if (content && content.classList.contains('expanded')) {
                    content.classList.remove('expanded');
                    content.classList.add('collapsed');
                    indicator.classList.add('collapsed');
                }
            });
        }

        function expandAll() {
            const panels = ['timeline-content', 'navigation-content', 'timer-content'];
            panels.forEach(panelId => {
                const content = document.getElementById(panelId);
                const indicatorId = panelId.replace('-content', '-indicator');
                const indicator = document.getElementById(indicatorId);
                
                if (content && content.classList.contains('collapsed')) {
                    content.classList.remove('collapsed');
                    content.classList.add('expanded');
                    indicator.classList.remove('collapsed');
                }
            });
        }

        function focusMode() {
            collapseAll();
            const content = document.getElementById('timeline-content');
            const indicator = document.getElementById('timeline-indicator');
            content.classList.remove('collapsed');
            content.classList.add('expanded');
            indicator.classList.remove('collapsed');
        }

        // Map controls
        function centerMap() {
            if (userLocation && map) {
                map.setCenter(userLocation);
                map.setZoom(14);
            }
        }

        function enableRouting() { console.log('Routing enabled'); }
        function toggleTraffic() { console.log('Traffic toggled'); }
        function toggleTracking() { console.log('Tracking toggled'); }

        function showLegend() {
            alert(`🎯 TACTICAL LEGEND\n\n🟢 HIGH STOCK (Best Buy)\n🟡 MEDIUM STOCK (Target)\n🔴 LOW STOCK (Walmart)\n🔵 SPECIALTY (GameStop)\n🟣 COMMAND CENTER (Home)`);
        }

        function scrollToNext() {
            if (nextEventIndex >= 0) {
                const container = document.getElementById('timeline-container');
                const events = container.querySelectorAll('.timeline-event');
                if (events[nextEventIndex]) {
                    events[nextEventIndex].scrollIntoView({ behavior: 'smooth', block: 'center' });
                }
            }
        }

        function resetTimeline() {
            const container = document.getElementById('timeline-container');
            container.scrollTop = 0;
        }

        // Mission control functions
        function initiateCountdown() { console.log('Countdown started'); }
        function pauseCountdown() { console.log('Countdown paused'); }
        function resetCountdown() { console.log('Countdown reset'); }

        // Update countdown timer
        function updateCountdown() {
            const targetDate = new Date('2025-06-01T00:00:00');
            const now = new Date();
            const timeLeft = targetDate - now;
            
            if (timeLeft > 0) {
                const days = Math.floor(timeLeft / (1000 * 60 * 60 * 24));
                const hours = Math.floor((timeLeft % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                const minutes = Math.floor((timeLeft % (1000 * 60 * 60)) / (1000 * 60));
                const seconds = Math.floor((timeLeft % (1000 * 60)) / 1000);
                
                document.getElementById('countdown').textContent = 
                    `${days}d ${hours}h ${minutes}m ${seconds}s`;
            } else {
                document.getElementById('countdown').textContent = 'MISSION ACTIVE';
            }
        }

        // Update timers every second
        setInterval(() => {
            updateCurrentTime();
            updateTimeline();
            updateCountdown();
        }, 1000);
        
        // Initialize
        updateCurrentTime();
        updateTimeline();
        updateCountdown();
    </script>
    <script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDhyuJmrGlrZvz3t5z1dKjOzHwt_OwrIaU&callback=initMap"></script>
</body>
</html>